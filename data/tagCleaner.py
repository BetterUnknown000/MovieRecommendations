import pandas as pd

def bulk_replace_tags(file_path, replacements_dict, output_file):
    # Load the CSV
    df = pd.read_csv(file_path)

    def replace_tags(cell):
        if pd.isna(cell):
            return cell
        tags = [tag.strip() for tag in cell.split(',')]
        updated_tags = []
        for tag in tags:
            replaced = False
            for target_word, replacement in replacements_dict.items():
                if target_word.lower() in tag.lower():
                    if replacement not in updated_tags:
                        updated_tags.append(replacement)
                    replaced = True
                    break  # Stop checking other words once one matches
            if not replaced:
                updated_tags.append(tag)
        return ', '.join(updated_tags)

    # Apply the replacement function
    df['tags'] = df['tags'].apply(replace_tags)

    # Save the updated CSV
    df.to_csv(output_file, index=False)
    print(f"Updated CSV saved to {output_file}")

# Example usage:
replacements = {
    "classic horror": "Horror",
    "alien abduction": "Horror",
    "british horror": "Horror",
    "occultism": "Horror",
    "frankenstein": "Horror",
    "evil doll": "Horror",
    "exorcism": "Horror",
    "demonic possession": "Horror",
    "dracula": "Horror",
    "demon": "Horror",
    "crypt keeper": "Horror",
    "evil nun": "Horror",
    "supernatural": "Horror",
    "boy": "Child",
    "boy next door": "Child",
    "teenage boy": "Child",
    "girl": "Child",
    "children": "Child",
    "childhood": "Child",
    "wild child": "Child",
    "teenage daughter": "Child",
    "teenage son": "Child",
    "toy": "Toy",
    "new toy": "Toy",
    "toy comes to life": "Toy",
    "doll": "Toy",
    "puppet": "Toy",
    "dog": "Animal",
    "wolf": "Animal",
    "bat": "Animal",
    "goose": "Animal",
    "insect": "Animal",
    "cat": "Animal",
    "gorilla": "Animal",
    "dolphin": "Animal",
    "fish": "Animal",
    "animal": "Animal",
    "chimp": "Animal",
    "ape": "Animal",
    "monkey": "Animal",
    "jealousy": "Emotion",
    "rage and hate": "Emotion",
    "lovesickness": "Emotion",
    "friendship": "Friendship",
    "loss of friend": "Friendship",
    "friends": "Friendship",
    "best friend": "Friendship",
    "brother brother relationship": "Family",
    "mother daughter relationship": "Family",
    "interracial relationship": "Relationship",
    "teacher student relationship": "School",
    "alcoholism": "Addiction",
    "alcohol abuse": "Addiction",
    "sexual obsession": "Addiction",
    "drug abuse": "Addiction",
    "based on novel": "Adaptation",
    "based on children's book": "Adaptation",
    "serial killer": "Crime",
    "crime": "Crime",
    "murder": "Crime",
    "bank robbery": "Crime",
    "hacker": "Crime",
    "ex-con": "Crime",
    "sexual exploitation": "Crime",
    "police": "Law Enforcement",
    "detective": "Law Enforcement",
    "district attorney": "Law Enforcement",
    "criminal defense lawyer": "Law Enforcement",
    "private investigator": "Law Enforcement",
    "agent": "Law Enforcement",
    "prison visitor": "Law Enforcement",
    "parole officer": "Law Enforcement",
    "juvenile prison": "Law Enforcement",
    "jail": "Law Enforcement",
    "shootout": "Violence",
    "gun fight": "Violence",
    "killing spree": "Violence",
    "pistol": "Violence",
    "gist fight": "Violence",
    "rape": "Crime",
    "drug smuggling": "Crime",
    "prostitution": "Crime",
    "violence": "Violence",
    "wound": "Violence",
    "killer": "Violence",
    "chase": "Exciting",
    "suspense": "Exciting",
    "explosion": "Exciting",
    "heist": "Crime",
    "ponzi scheme": "Crime",
    "money": "Wealth",
    "mafia": "Crime",
    "gang": "Crime",
    "casino": "Gambling",
    "hotel room": "Hotel",
    "los angeles": "USA",
    "paris": "France",
    "seattle": "USA",
    "new york city": "USA",
    "st. petersburg russia": "Russia",
    "detroit michigan": "USA",
    "space": "Science",
    "time travel": "Science",
    "astronaut": "Science",
    "virus": "Science",
    "science fiction": "Science",
    "post-apocalyptic": "Apocalypse",
    "teacher": "School",
    "hitman": "Crime",
    "smuggler": "Crime",
    "kidnapping": "Crime",
    "exploitation": "Crime",
    "drug": "Crime",
    "drug use": "Crime",
    "cop": "Law Enforcement",
    "president": "Political",
    "usa president": "Political",
    "united nations": "Political",
    "election": "Political",
    "white house": "Political",
    "senator": "Political",
    "mother": "Family",
    "father": "Family",
    "brother": "Family",
    "sister": "Family",
    "cousin": "Family",
    "uncle": "Family",
    "aunt": "Family",
    "marriage": "Relationship",
    "divorce": "Relationship",
    "widow": "Relationship",
    "widower": "Relationship",
    "couple": "Relationship",
    "dating": "Relationship",
    "child custody": "Relationship",
    "past relationship": "Relationship",
    "gay relationship": "Relationship",
    "romance": "Relationship",
    "ex-wife": "Relationship",
    "sex": "Relationship",
    "miami": "USA",
    "southern usa": "USA",
    "cia": "Law Enforcement",
    "poker": "Gambling",
    "shot": "Violence",
    "eaten alive": "Violence",
    "shoot": "Violence",
    "gun": "Violence",
    "gore": "Violence",
    "blood": "Violence",
    "knife": "Violence",
    "stab": "Violence",
    "bank": "Wealth",
    "philadelphia": "USA",
    "terrorist": "Crime",
    "island": "Tropical",
    "love": "Relationship",
    "dying": "Death",
    "die": "Death",
    "death": "Death",
    "exploding planet": "Death",
    "funeral": "Death",
    "kamikaze": "Death",
    "ghost story": "Death",
    "throat slitting": "Death",
    "music": "Musical",
    "musician": "Musical",
    "opera singer": "Musical",
    "guitar": "Musical",
    "guitarist": "Musical",
    "drummer": "Musical",
    "pianist": "Musical",
    "singer": "Musical",
    "punk band": "Musical",
    "bassist": "Musical",
    "bollywood": "Musical",
    "monster": "Scary",
    "beast": "Scary",
    "vampire": "Scary",
    "political": "Political",
    "family": "Family",
    "true story": "Adaptation",
    "based on young adult novel": "Adaptation",
    "horror novel": "Adaptation",
    "based on tv series": "Adaptation",
    "based on cartoon": "Adaptation",
    "based on short story": "Adaptation",
    "based on movie": "Adaptation",
    "based on game": "Adaptation",
    "based on fairy tale": "Adaptation",
    "based on memoir or autobiography": "Adaptation",
    "based on myths or folklore": "Adaptation",

    # Add more mappings as needed
}

bulk_replace_tags("cleaned_movies.csv", replacements, "final_movies.csv")
